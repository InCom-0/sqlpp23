[**< Index**](README.md)

# Prepared Statements
Executing a statement in a database is typically done in two phases: First, the statement is prepared (parsed, compiled, optimized). Then, it is run against the database. Since statements often differ only in parameters, not in structure, many databases offer to store prepared statements. These prepared statements can then be executed repeatedly, typically with some parameters.

sqlpp23 supports prepared statements.

## Parameters
There are two overloads to specify a parameter:

```C++
parameter(const DataType&, const AliasProvider&);

parameter(const NamedExpression&)
```

- DataType has to be an [sqlpp23 data type](data_types.md).
- AliasProviders can be generated by using the `SQLPP_CREATE_NAME_TAG` macro (at namespace level).
- Named expressions are expressions with an sqlpp23 data type and a name, e.g. a table or a column.

For instance, you could use:
```C++
SQLPP_CREATE_NAME_TAG(cheese); // outside of function
// ...
parameter(sqlpp::integral{}, cheese);

parameter(tab.id);
```

## Prepare and execute statements
insert, update, remove and select statements can be prepared by calling the `prepare()` method of a database connection object.

```C++
auto prepared_statement = db.prepare(some_statement);
```

You can now set the parameters and execute the prepared statement multiple times, e.g.

```C++
auto prepared_insert = db.prepare(
    insert_into(tab).set(
                tab.alpha = parameter(tab.alpha),
                tab.beta = parameter(sqlpp::text(), cheese)
    ));
for (const auto& input : input_values)
{
   prepared_insert.params.alpha = input.first;
   prepared_insert.params.cheese = input.second;
   db(prepared_insert);
}
```

[**< Index**](README.md)
